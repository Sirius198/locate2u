(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[117],{39574:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/transfer",function(){return t(7478)}])},7478:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return on}});var o,i=t(47568),r=t(26042),s=t(34051),a=t.n(s),c=t(85893),l=t(3413),d=t(69396),u=t(99534),x=t(828),m=t(94862),f=t(25344),h=t(80975),v=t(67294),g=t(8552),p=function(n){var e=n.isShowing,t=n.onRequestClose,o=n.tokenSymbol,i=n.href;return(0,c.jsxs)(h.Vq,{isShowing:e,onRequestClose:t,children:[(0,c.jsx)(h.fK,{paddingBottom:"$10",children:(0,c.jsx)(h.xv,{variant:"header",children:"External asset deposit"})}),(0,c.jsxs)(h.cZ,{css:{paddingBottom:"$12"},children:[(0,c.jsxs)(h.xv,{css:{paddingBottom:"$12"},variant:"body",children:["You will be redirected to an external service to deposit your"," ",o," on the chain."]}),(0,c.jsx)(h.zx,{as:"a",href:i,target:"__blank",css:{width:"100%"},size:"large",onClick:t,children:"Proceed"})]})]})};!function(n){n.fetching="FETCHING",n.active="ACTIVE"}(o||(o={}));var j=function(n){var e=n.tokenSymbol,t=n.onActionClick,i=n.balance,s=n.state,a=(0,u.Z)(n,["tokenSymbol","onActionClick","balance","state"]),l=(0,m.Bp)(e)||{},j=l.symbol,y=l.name,w=l.logoURI,S=l.external_deposit_uri,$=(0,v.useState)(!1),C=$[0],A=$[1],T=(0,x.Z)((0,f.t)(e),1)[0],Z=Boolean(S),z=function(){if(Z)return A(!0);t({tokenSymbol:j,actionType:"deposit"})};if(s===o.fetching)return(0,c.jsxs)(b,(0,d.Z)((0,r.Z)({},a),{kind:"wrapper",children:[(0,c.jsx)(b,{kind:"content",children:(0,c.jsx)(k,{children:(0,c.jsx)(h.zr,{size:"big"})})}),(0,c.jsx)("div",{})]}));var B=i>0;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(b,(0,d.Z)((0,r.Z)({active:B},a),{kind:"wrapper",children:[(0,c.jsx)(b,{kind:"content",children:(0,c.jsxs)(k,{children:[(0,c.jsx)(h.zr,{logoURI:w,size:"big"}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(h.xv,{variant:"primary",children:[B?i:null," ",y]}),B&&(0,c.jsxs)(h.xv,{variant:"caption",css:{paddingTop:"$1"},children:["$",(0,h.MK)(T*i,{includeCommaSeparation:!0})]})]})]})}),(0,c.jsx)(b,{kind:"actions",children:Z?(0,c.jsx)(h.zx,{disabled:!g.AZ,onClick:z,iconRight:(0,c.jsx)(h.Hf,{rotation:"45deg"}),variant:"ghost",children:"Transfer"}):(0,c.jsxs)(c.Fragment,{children:[i>0&&(0,c.jsx)(h.zx,{disabled:!g.AZ,onClick:g.AZ?function(){return t({tokenSymbol:j,actionType:"withdraw"})}:void 0,iconRight:(0,c.jsx)(h.Hf,{}),variant:"ghost",children:"Withdraw"}),(0,c.jsx)(h.zx,{disabled:!g.AZ,onClick:g.AZ?z:void 0,iconRight:(0,c.jsx)(h.Hf,{rotation:"180deg"}),variant:"ghost",children:"Deposit"})]})})]})),Z&&(0,c.jsx)(p,{isShowing:C,onRequestClose:function(){return A(!1)},tokenSymbol:e,href:S})]})},b=(0,h.zo)("div",{variants:{kind:{wrapper:{background:"$colors$dark10",borderRadius:"$2",padding:"$9 $12",display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",overflow:"hidden"},content:{display:"grid",gridAutoFlow:"column",columnGap:"$space$10",position:"relative",zIndex:1},actions:{display:"grid",gridAutoFlow:"column",columnGap:"$space$6",position:"relative",zIndex:1}},active:{true:{boxShadow:"$light",border:"1px solid $borderColors$default",backgroundColor:"$base"}}}}),k=(0,h.zo)("div",{display:"grid",gridAutoFlow:"column",columnGap:"$6",alignItems:"center"}),y=t(4480),w=t(78284),S=t(41719),$=t(31952),C=function(n){var e=n.onActionClick,t=(0,x.Z)(function(){var n=(0,x.Z)((0,S.g)(),1)[0],e=(0,v.useMemo)((function(){return null===n||void 0===n?void 0:n.tokens.map((function(n){return n.symbol}))}),[n]),t=(0,x.Z)((0,$.V)(e),2),o=t[0],i=t[1],r=(0,v.useMemo)((function(){var n;if(!(null===o||void 0===o?void 0:o.length))return[[],null!==(n=null===e||void 0===e?void 0:e.map((function(n){return{balance:0,tokenSymbol:n}})))&&void 0!==n?n:[]];var t=[],i=[],r=!0,s=!1,a=void 0;try{for(var c,l=o[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var d=c.value;d.balance>0?t.push(d):i.push(d)}}catch(u){s=!0,a=u}finally{try{r||null==l.return||l.return()}finally{if(s)throw a}}return[t,i]}),[o,e]);return[i,r]}(),2),i=t[0],r=(0,x.Z)(t[1],2),s=r[0],a=r[1],l=function(n){var e=(0,y.sJ)(n).status,t=e===w.Hm.connected;return{isConnecting:e===w.Hm.connecting||e===w.Hm.restored,isConnected:t}}(w.Zc),d=l.isConnecting,u=l.isConnected,m=d||i,f=u&&!i&&s.length>0,p=(0,h.yM)(m,650);return m&&!p?null:(0,c.jsxs)(c.Fragment,{children:[g.AZ&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(h.xv,{variant:"primary",css:{paddingBottom:"$12"},children:"My assets"}),(0,c.jsx)(A,{children:m?(0,c.jsx)(j,{state:o.fetching}):(0,c.jsxs)(c.Fragment,{children:[f&&s.map((function(n){var t=n.tokenSymbol,i=n.balance;return(0,c.jsx)(j,{state:o.active,tokenSymbol:t,onActionClick:e,balance:i},t)})),u&&!f&&(0,c.jsx)(h.xv,{variant:"body",as:"span",children:"No IBC assets... yet!"}),!u&&!m&&(0,c.jsxs)(h.xv,{variant:"body",children:["Connect your wallet"," ",(0,c.jsx)(h.xv,{variant:"body",as:"span",children:"to see your tokens."})]})]})})]}),(0,c.jsx)(h.xv,{variant:"primary",css:{paddingTop:g.AZ?"$16":"0",paddingBottom:g.AZ?"$12":"$6"},children:g.AZ?"Other tokens":"Soon available to transfer"}),(0,c.jsx)(A,{children:g.AZ&&m?(0,c.jsx)(c.Fragment,{children:new Array(3).fill(0).map((function(n,e){return(0,c.jsx)(j,{style:{opacity:1-(e>0?.2+.2*e:0)},state:o.fetching},e)}))}):(0,c.jsx)(c.Fragment,{children:null===a||void 0===a?void 0:a.map((function(n){var t=n.tokenSymbol,o=n.balance;return(0,c.jsx)(j,{tokenSymbol:t,onActionClick:e,balance:o},t)}))})}),(0,c.jsx)(h.xv,{variant:"caption",align:"center",color:"disabled",css:{padding:"$16 0",borderBottom:"1px solid $borderColors$inactive"},children:"More tokens available soon"})]})},A=(0,h.zo)("div",{display:"grid",rowGap:"$space$4"}),T=t(63912),Z=t(65047),z=t(86501),B=function(n){var e=n.amount,t=n.maxApplicableAmount,o=n.onAmountChange,i=(0,h.r7)(),s=i.isFocused,a=i.bind;return(0,c.jsxs)(_,(0,d.Z)((0,r.Z)({variant:"secondary",selected:s},a.button),{children:[(0,c.jsxs)(E,{children:[(0,c.jsx)(h.zx,{onClick:function(){return o(t)},variant:"secondary",size:"small",children:"Max"}),(0,c.jsx)(h.zx,{onClick:function(){return o(t/2)},variant:"secondary",size:"small",children:"1/2"})]}),(0,c.jsx)(I,{children:(0,c.jsx)(h.xv,{variant:"primary",align:"right",children:(0,c.jsx)(h.V$,(0,r.Z)({value:Number((0,h.a)(e)),min:0,max:t,onChange:o},a.input))})})]}))},_=(0,h.zo)(h.xd,{padding:"$8 $12 $8 $8 !important"}),E=(0,h.zo)("div",{columnGap:"$space$4",display:"flex",alignItems:"center"}),I=(0,h.zo)("div",{}),F=function(n){var e=n.activeTokenSymbol,t=n.onSelect,o=n.fetchingBalanceMode,i=(0,u.Z)(n,["activeTokenSymbol","onSelect","fetchingBalanceMode"]),s=(0,x.Z)((0,S.g)(),1)[0];return(0,c.jsx)(l.q6,(0,d.Z)((0,r.Z)({},i),{tokenList:s.tokens,activeTokenSymbol:e,onSelect:t,visibleNumberOfTokensInViewport:2.5,fetchingBalanceMode:o}))},R=function(n){var e=n.activeTokenSymbol,t=n.onTokenSymbolSelect,o=n.fetchingBalancesAgainstChain,i=function(){b(!j)},r=(0,m.Bp)(e),s=(0,T.E)(e),a=s.balance,l=s.isLoading,d=(0,$.m)(e),u=d.balance,x=d.isLoading,f="ibc"===o?a:u,g="ibc"===o?l:x,p=(0,v.useState)(!1),j=p[0],b=p[1];return(0,c.jsxs)(M,{children:[(0,c.jsxs)(N,{variant:"secondary",onClick:i,children:[(0,c.jsxs)(q,{children:[(0,c.jsx)(h.zr,{size:"big",logoURI:r.logoURI,alt:e}),(0,c.jsxs)("div",{children:[(0,c.jsx)(h.xv,{variant:"body",children:e}),(0,c.jsxs)(h.xv,{variant:"secondary",children:[(0,h.a)(f)," available"]})]})]}),(0,c.jsx)(h.zx,{variant:"ghost",onClick:i,icon:(0,c.jsx)(h.a1,{size:"medium",rotation:"-90deg",color:"tertiary",icon:g?(0,c.jsx)(h.$j,{size:16}):(0,c.jsx)(c.Fragment,{children:j?(0,c.jsx)(h.EJ,{}):(0,c.jsx)(h.Tt,{})})})})]}),j&&(0,c.jsx)(F,{activeTokenSymbol:e,fetchingBalanceMode:o,onSelect:function(n){t(n),b(!1)},css:{padding:"$1 $4 $12"}})]})},M=(0,h.zo)("div",{backgroundColor:"$colors$dark10",borderRadius:"$1"}),N=(0,h.zo)(h.xd,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",cursor:"pointer",userSelect:"none",padding:"$8 $5 $8 $8 !important",columnGap:"$space$6"}),q=(0,h.zo)("div",{display:"flex",flexDirection:"row",alignItems:"center",columnGap:"$space$6"}),H=t(39385),K=t(43720),G=t.n(K),P=t(88767),D=t(71505),O=function(n,e,t,o,i,r,s){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",c=arguments.length>8?arguments[8]:void 0,l=s?G().fromNumber(s).multiply(1e9):void 0,d={typeUrl:"/ibc.applications.transfer.v1.MsgTransfer",value:H.MsgTransfer.fromPartial({sourcePort:o,sourceChannel:i,sender:n,receiver:e,token:t,timeoutHeight:r,timeoutTimestamp:l})};return c.signAndBroadcast(n,[d],"auto",a)},J=t(46512),L=function(n){var e=n.label,t=n.icon,o=n.address,i=n.css;return(0,c.jsxs)(W,{css:i,children:[t,(0,c.jsxs)("div",{children:[(0,c.jsx)(h.xv,{variant:"primary",children:e}),(0,c.jsxs)(X,{children:[(0,c.jsx)(h.Ph,{color:"secondary",size:"medium"}),(0,c.jsx)(h.xv,{truncate:!0,variant:"legend",children:o||"address wasn't identified yet"})]})]})]})},U=function(n){var e=n.css,t=n.depositing,o=(0,y.sJ)(w.OX).address;return(0,c.jsx)(L,{css:e,label:"".concat(t?"To ":"","Keplr wallet"),icon:(0,c.jsx)(Y,{src:"/img/keplr-icon.png",alt:"Keplr wallet"}),address:o})},V=function(n){var e=n.css,t=n.depositing,o=(0,y.sJ)(w.Zc).address;return(0,c.jsx)(L,{css:e,label:"".concat(t?"To ":"").concat(g.iC),icon:(0,c.jsx)(h.a1,{color:"secondary",size:"big",icon:(0,c.jsx)(J.TR,{})}),address:o})},W=(0,h.zo)("div",{display:"flex",alignItems:"center",columnGap:"$space$10"}),X=(0,h.zo)("div",{columnGap:"$space$2",display:"flex",alignItems:"center"}),Y=(0,h.zo)("img",{width:32,height:32}),Q=function(n){var e=n.tokenSymbol,t=n.transactionKind,o=n.isShowing,r=n.onRequestClose,s=n.onTokenSelect,l=(0,m.Bp)(e),d=l.deposit_gas_fee?l.deposit_gas_fee:.01,x=(0,T.E)(e).balance,f=(0,$.m)(e).balance,g=(0,v.useState)(0),p=g[0],j=g[1],b=(0,Z.S)(["tokenBalance","ibcTokenBalance"]),k=function(n){var e=n.transactionKind,t=n.tokenAmount,o=n.tokenInfo,r=(0,u.Z)(n,["transactionKind","tokenAmount","tokenInfo"]),s=(0,y.sJ)(w.Zc),c=s.address,l=s.client,d=(0,y.sJ)(w.OX),x=d.address,m=d.client;return(0,P.useMutation)((0,i.Z)(a().mark((function n(){var i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=Math.floor((new Date).getTime()/1e3)+120,"deposit"!=e){n.next=6;break}return console.log((0,D.q7)(t,o.decimals).toString()),n.next=5,m.sendIbcTokens(x,c,{amount:(0,D.q7)(t,o.decimals).toString(),denom:o.denom},"transfer",o.channel,void 0,i,"auto");case 5:case 9:return n.abrupt("return",n.sent);case 6:if("withdraw"!=e){n.next=10;break}return n.next=9,O(c,x,{amount:(0,D.q7)(t,o.decimals).toString(),denom:o.mun_denom},"transfer",o.mun_channel,void 0,i,"",l);case 10:case"end":return n.stop()}}),n)}))),r)}({transactionKind:t,tokenAmount:p,tokenInfo:l,onSuccess:function(){b(),z.Am.custom((function(n){return(0,c.jsx)(h.FN,{icon:(0,c.jsx)(h.a1,{icon:(0,c.jsx)(h.An,{}),color:"valid"}),title:"".concat(e," ").concat("deposit"===t?"deposit":"withdrawal"," successfully initiated"),onClose:function(){return z.Am.dismiss(n.id)}})})),requestAnimationFrame(r)},onError:function(n){var e;z.Am.custom((function(o){var i;return(0,c.jsx)(h.FN,{icon:(0,c.jsx)(h.a1,{icon:(0,c.jsx)(h.jj,{}),color:"error"}),title:"Couldn't ".concat("deposit"===t?"Deposit":"Withdraw"," the asset"),body:null!==(e=null===(i=n)||void 0===i?void 0:i.message)&&void 0!==e?e:null===n||void 0===n?void 0:n.toString(),buttons:(0,c.jsx)(h.zx,{as:"a",variant:"ghost",href:"http://discord.gg/mun",target:"__blank",iconRight:(0,c.jsx)(h.fu,{}),children:"Provide feedback"}),onClose:function(){return z.Am.dismiss(o.id)}})}))}}),S=k.isLoading,C=k.mutate,A="deposit"===t?"Deposit":"Withdraw",_="deposit"===t?U:V,E="withdraw"===t?U:V;return(0,c.jsxs)(h.Vq,{isShowing:o,onRequestClose:r,children:[(0,c.jsx)(h.fK,{paddingBottom:"$13",children:(0,c.jsx)(h.xv,{variant:"header",children:A})}),(0,c.jsxs)(h.cZ,{children:[(0,c.jsx)(_,{css:{paddingBottom:"$12"}}),(0,c.jsx)(R,{activeTokenSymbol:e,onTokenSymbolSelect:s,fetchingBalancesAgainstChain:"deposit"===t?"ibc":"native"})]}),(0,c.jsx)(h.EA,{offsetY:"$10"}),(0,c.jsxs)(h.cZ,{children:[(0,c.jsx)(h.xv,{variant:"primary",css:{paddingBottom:"$6"},children:"Amount"}),(0,c.jsx)(B,{maxApplicableAmount:"deposit"===t?Math.max(x-d,0):f,amount:p,onAmountChange:j})]}),(0,c.jsx)(h.EA,{offsetY:"$10"}),(0,c.jsx)(h.cZ,{css:{paddingBottom:"$8"},children:(0,c.jsx)(E,{depositing:!0})}),(0,c.jsx)(h.hG,{cancellationButton:(0,c.jsx)(h.zx,{onClick:r,variant:"secondary",children:"Cancel"}),confirmationButton:(0,c.jsx)(h.zx,{disabled:"deposit"===t?x<=0:f<=0,onClick:function(){return C(null)},variant:"primary",children:S?(0,c.jsx)(h.$j,{instant:!0,size:16}):"Transfer"})})]})},nn=t(74926),en=t(24658),tn=t(21405);function on(){var n=(0,v.useReducer)((function(n,e){return(0,r.Z)({},n,e)}),{transactionKind:"deposit",isTransferDialogShowing:!1,selectedToken:null}),e=n[0],t=e.transactionKind,o=e.isTransferDialogShowing,s=e.selectedToken,u=n[1],f=function(n,e){var t=(0,x.Z)((0,y.FV)(w.OX),2),o=t[0],s=o.status,c=o.tokenSymbol,l=t[1],u=(0,m.Bp)(n||c),f=(0,P.useMutation)((0,i.Z)(a().mark((function e(){var t,o,i,s,m,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window||(null===window||void 0===window?void 0:window.keplr)){e.next=3;break}return alert("Please install Keplr extension and refresh the page."),e.abrupt("return");case 3:if(n||c){e.next=5;break}throw new Error("You must provide `tokenSymbol` before connecting to the wallet.");case 5:if(u){e.next=7;break}throw new Error("Asset info for the provided `tokenSymbol` was not found. Check your internet connection.");case 7:return l((function(e){return(0,d.Z)((0,r.Z)({},e),{tokenSymbol:n,client:null,state:w.Hm.connecting})})),e.prev=8,t=u.chain_id,o=u.rpc,e.next=12,window.keplr.enable(t);case 12:return e.next=14,window.getOfflineSigner(t);case 14:return i=e.sent,e.next=17,en.SigningStargateClient.connectWithSigner(o,i,{gasPrice:en.GasPrice.fromString(g.DB),aminoTypes:new en.AminoTypes(Object.assign((0,en.createIbcAminoConverters)(),(0,nn.tW)()))});case 17:return s=e.sent,e.t0=x.Z,e.next=21,i.getAccounts();case 21:e.t1=e.sent,m=(0,e.t0)(e.t1,1),f=m[0].address,l({tokenSymbol:n,address:f,client:s,status:w.Hm.connected}),e.next=31;break;case 27:throw e.prev=27,e.t2=e.catch(8),l({tokenSymbol:null,address:"",client:null,status:w.Hm.error}),e.t2;case 31:case"end":return e.stop()}}),e,null,[[8,27]])}))),e),h=f.mutate;return(0,v.useEffect)((function(){s===w.Hm.restored&&u&&h(null)}),[s,h,u]),(0,v.useEffect)((function(){var n=function(){u&&s===w.Hm.connected&&h(null)};return window.addEventListener("keplr_keystorechange",n),function(){window.removeEventListener("keplr_keystorechange",n)}}),[h,s,u]),f}(s,{onError:function(n){z.Am.custom((function(e){return(0,c.jsx)(h.FN,{icon:(0,c.jsx)(h.a1,{icon:(0,c.jsx)(h.jj,{}),color:"error"}),title:"Cannot get wallet address for ".concat(s),body:null===n||void 0===n?void 0:n.toString(),buttons:(0,c.jsx)(h.zx,{as:"a",variant:"ghost",href:"http://discord.gg/mun",target:"__blank",iconRight:(0,c.jsx)(h.fu,{}),children:"Provide feedback"}),onClose:function(){return z.Am.dismiss(e.id)}})}))}}),p=f.mutate,j=(0,tn.O)({onError:function(n){var e,t;z.Am.custom((function(o){var i;return(0,c.jsx)(h.FN,{icon:(0,c.jsx)(h.a1,{icon:(0,c.jsx)(h.jj,{}),color:"error"}),title:"Cannot connect to your wallet",body:null!==(t=null!==(e=null===(i=n)||void 0===i?void 0:i.message)&&void 0!==e?e:null===n||void 0===n?void 0:n.toString())&&void 0!==t?t:"Unknown error.",buttons:(0,c.jsx)(h.zx,{as:"a",variant:"ghost",href:"http://discord.gg/mun",target:"__blank",iconRight:(0,c.jsx)(h.fu,{}),children:"Provide feedback"}),onClose:function(){return z.Am.dismiss(o.id)}})}))}}),b=j.mutate,k=(0,y.sJ)(w.Zc).status;return(0,v.useEffect)((function(){function n(){return(n=(0,i.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(k===w.Hm.connected){n.next=4;break}return console.log("going to connect internal wallet first"),n.next=4,b(null);case 4:p(null);case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}s&&function(){n.apply(this,arguments)}()}),[p,b,s,k]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.LN,{children:(0,c.jsxs)(rn,{children:[(0,c.jsx)(l.mr,{title:"IBC Transfer",subtitle:"Easily and quickly initiate payments across IBC. Be careful this is MUN TESTNET, only transfer very small amounts to test IBC transfers."}),(0,c.jsx)(C,{onActionClick:function(n){var e=n.actionType,t=n.tokenSymbol;u({transactionKind:e,selectedToken:t,isTransferDialogShowing:!0})}})]})}),s&&(0,c.jsx)(Q,{tokenSymbol:s,transactionKind:t,isShowing:o,onTokenSelect:function(n){u({selectedToken:n})},onRequestClose:function(){u({isTransferDialogShowing:!1})}})]})}var rn=(0,h.zo)("section",{paddingBottom:"$17"})}},function(n){n.O(0,[78,714,631,506,399,702,298,774,888,179],(function(){return e=39574,n(n.s=e);var e}));var e=n.O();_N_E=e}]);